{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans "AI Yield Prediction" %}{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">{% trans "AI Yield Prediction" %}</h1>

<p class="text-gray-600 mb-6">
  {% trans "Fill in the details of your farm to estimate the expected crop yield, harvest date, and potential market value." %}
</p>

{% if result %}
  <!-- Results view -->
  <h2 class="text-xl font-semibold mb-4">{% trans "Results" %}</h2>

  <div class="mt-6 grid md:grid-cols-4 gap-4">
    <div class="bg-white p-4 rounded-2xl shadow">
      <div class="text-sm text-gray-600">{% trans "Expected Yield (kg)" %}</div>
      <div class="text-2xl font-bold">{{ result.expected_yield_kg }}</div>
    </div>
    <div class="bg-white p-4 rounded-2xl shadow">
      <div class="text-sm text-gray-600">{% trans "Value (₦)" %}</div>
      <div class="text-2xl font-bold">{{ result.expected_value_ngn|floatformat:0 }}</div>
    </div>
    <div class="bg-white p-4 rounded-2xl shadow">
      <div class="text-sm text-gray-600">{% trans "Harvest Date" %}</div>
      <div class="text-2xl font-bold">{{ result.expected_harvest_date }}</div>
    </div>
    <div class="bg-white p-4 rounded-2xl shadow">
      <div class="text-sm text-gray-600">{% trans "Market Price (₦/kg)" %}</div>
      <div class="text-2xl font-bold">{{ result.market_price_per_kg }}</div>
    </div>
  </div>

  <div class="mt-4 text-sm text-gray-600">
    <details class="bg-white p-4 rounded-2xl shadow">
      <summary class="cursor-pointer">{% trans "Assumptions" %}</summary>
      <ul class="list-disc pl-6">
        <li>{% trans "Yield per plant (kg)" %}: {{ result.assumptions.yield_per_plant_kg }}</li>
        <li>{% trans "Soil factor" %}: {{ result.assumptions.soil_factor }}</li>
        <li>{% trans "Irrigation factor" %}: {{ result.assumptions.irrigation_factor }}</li>
        <li>{% trans "Days to maturity" %}: {{ result.assumptions.days_to_maturity }}</li>
      </ul>
    </details>
  </div>

  <!-- Optional: add a button to go back to form -->
  <div class="mt-6">
    <a href="{% url 'yield_form' %}" class="px-4 py-2 bg-gray-200 rounded-xl">{% trans "New Calculation" %}</a>
  </div>

{% else %}
  <!-- Form view (only shown before calculation) -->
  <form method="post" class="grid md:grid-cols-2 gap-4 bg-white p-6 rounded-2xl shadow">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="md:col-span-2">
      <button class="px-4 py-2 bg-black text-white rounded-xl">{% trans "Calculate" %}</button>
    </div>
  </form>
{% endif %}

{% endblock %}
